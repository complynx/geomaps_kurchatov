<!DOCTYPE html>
<html>
<!--
Created by Complynx on 22.03.2019,
http://complynx.net
<complynx@yandex.ru> Daniel Drizhuk
-->
<head lang="en">
    <meta charset="UTF-8">
    <script src="https://www.webglearth.com/v2/api.js"></script>
    <title>test page gl</title>
    <link rel="stylesheet" href="./main.css"/>
    <script type="module">
        import {init} from "./scripts/map_init.js";
        import {dirname} from "/modules/utils.js";

        window.addEventListener("load", ()=>{
            try {
                let map = new WE.map('map', {
                    center: [55, 37],
                    zoom: 3
                });
                init(map, WE);
            }catch (e) {
                let m = document.querySelector("#map");
                m.classList.add('gl-fail');
                m.innerHTML=`
                <a href="./index.html">Failed to initialize WebGL, switch to 2D view.<br>
                Ошибка инициализации WebGL, переключить на режим 2D.</a>
                `;
                setTimeout(()=>{
                    location.replace(location.origin + dirname(location.pathname) + '/index.html'
                        + (location.search || "") + (location.hash || ""));
                }, 2000);
            }
        }, {once:true});
    </script>
</head>
<body class="gl">
    <div id="map"></div>
</body>
</html>